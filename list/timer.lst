C51 COMPILER V9.53.0.0   TIMER                                                             09/19/2016 16:10:29 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\out\timer.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE src\timer.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\inc) DEBUG OBJECTEXT
                    -END PRINT(.\list\timer.lst) OBJECT(.\out\timer.obj)

line level    source

   1          //定时器0和定时器1的
   2          
   3          #include "includes.h"
   4          
   5          //定时器0 模式1 10ms 18.432MHz  12T
   6          unsigned char Timer0_H = 0xC4;
   7          unsigned char Timer0_L = 0x00;
   8          
   9          volatile unsigned int T_Count0 = 0;
  10          
  11          
  12          
  13          void Timer0Init(void)           //1ms@18.432MHz
  14          {
  15   1              AUXR &= 0x7F;           //定时器时钟设置为12T模式
  16   1              TMOD &= 0xF0;           //清空定时器0的模式设置位
  17   1              TMOD |= 0x01;           //设置定时器0为工作模式1
  18   1              TL0 = Timer0_L;         //设置定时器初始值
  19   1              TH0 = Timer0_H;         //设置定时器初始值
  20   1              TF0 = 0;                        //清除TF0中断标志
  21   1              ET0 = 1;                        //允许定时器0的溢出中断
  22   1              
  23   1      //      EA = 1;                 //总中断
  24   1              TR0 = 1;                        //定时器0开始计数
  25   1      }
  26          
  27          
  28          void Timer0IntServer(void) interrupt 1
  29          {
  30   1              TL0 = Timer0_L;         //设置定时器初始值
  31   1              TH0 = Timer0_H;         //设置定时器初始值
  32   1              
  33   1              T_Count0++;
  34   1      }
  35          
  36          
  37          //如果串口不使用定时器1 就做为八位自动重装定时器使用
  38          #ifndef USRT_USE_TIMER1 
  39          
  40          //定时器1 模式2 100us 18.432MHz 12T
  41          unsigned char Timer1_H = 0x66;
  42          unsigned char Timer1_L = 0x66;
  43          
  44          volatile unsigned int T_Count1 = 0;
  45          
  46          void Timer1Init(void)
  47          {
  48   1              AUXR &= 0xBF;           //定时器1时钟设置为12T模式
  49   1              TMOD &= 0x0F;           //清空定时器1的模式设置位
  50   1              TMOD |= 0x20;           //设置定时器1为工作模式2
  51   1              TL1= Timer1_L;          //设置定时器初始值
  52   1              TH1 = TL1;                      //设置定时器重装初始值
  53   1              TF1 = 0;                        //清除TF1中断标志
  54   1              ET1 = 1;                        //允许定时器1的溢出中断
C51 COMPILER V9.53.0.0   TIMER                                                             09/19/2016 16:10:29 PAGE 2   

  55   1              
  56   1              TR1 = 1;                        //定时器1开始计数
  57   1      }
  58          
  59          //定时器1的中断服务函数
  60          void Timer_Routine(void) interrupt 3
  61          {
  62   1              if(T_Count1++ == 5000)
  63   1              {
  64   2                      T_Count1 = 0;
  65   2                      LED33 = !LED33;
  66   2              }
  67   1      }
  68          
  69          
  70          
  71          #endif
  72          
  73          
  74          
  75          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    156    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      8    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
